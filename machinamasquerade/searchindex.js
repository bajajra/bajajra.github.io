Search.setIndex({"alltitles": {"Advanced Configuration & Scaling": [[1, "advanced-configuration-scaling"]], "Algorithm in prose": [[2, "algorithm-in-prose"]], "An example cell": [[5, "an-example-cell"]], "Choosing Hyper\u2011parameters": [[1, "choosing-hyperparameters"]], "Citations": [[4, "citations"]], "Code blocks and outputs": [[6, "code-blocks-and-outputs"]], "Content in Jupyter Book": [[0, null]], "Content with notebooks": [[6, null]], "Core Concepts and Notation": [[7, "core-concepts-and-notation"]], "Correlating Theory with Code": [[1, "correlating-theory-with-code"]], "Courses": [[3, "courses"]], "Create a notebook with MyST Markdown": [[5, "create-a-notebook-with-myst-markdown"]], "Dataset Preparation": [[1, "dataset-preparation"]], "Designing a Reward Function": [[1, "designing-a-reward-function"]], "Environment & Dependencies": [[1, "environment-dependencies"]], "From PPO to GRPO: the mathematical step": [[2, "from-ppo-to-grpo-the-mathematical-step"]], "GRPO in a Nutshell": [[1, "grpo-in-a-nutshell"]], "GRPO: Huggingface Implementation": [[1, null]], "Group Relative Policy Optimisation (GRPO): Overview": [[2, null]], "How Large Language Models (LLMs) Operate": [[7, "how-large-language-models-llms-operate"]], "Key idea: ditch the critic": [[2, "key-idea-ditch-the-critic"]], "Learn more": [[4, "learn-more"]], "LoRA\u00a0+ 4\u2011bit Quant": [[1, "lora-4bit-quant"]], "Markdown + notebooks": [[6, "markdown-notebooks"]], "Markdown Files": [[4, null]], "Mathematical Perspective on RL in LLMs": [[7, "mathematical-perspective-on-rl-in-llms"]], "Multi\u2011GPU & FSDP": [[1, "multigpu-fsdp"]], "MyST markdown": [[6, "myst-markdown"]], "Next-Token Prediction": [[7, "next-token-prediction"]], "Notebooks with MyST Markdown": [[5, null]], "PPO v/s GRPO": [[2, "ppo-v-s-grpo"]], "Practical Learnings": [[1, "practical-learnings"]], "Quickly add YAML metadata for MyST Notebooks": [[5, "quickly-add-yaml-metadata-for-myst-notebooks"]], "RL Introduction": [[7, null]], "Real-World Example: Self-Driving Cars": [[7, "real-world-example-self-driving-cars"]], "Recap: PPO clip objective": [[2, "recap-ppo-clip-objective"]], "Reinforcement Learning Alignment in LLMs": [[7, "reinforcement-learning-alignment-in-llms"]], "Reinforcement Learning for LLMs": [[3, null]], "Reward Models": [[8, null]], "Sample Roles and Directives": [[4, "sample-roles-and-directives"]], "Toy Example (Arithmetic)": [[2, "toy-example-arithmetic"]], "Track:": [[1, "track"]], "Training Flow for Modern LLMs": [[7, "training-flow-for-modern-llms"]], "Welcome to Machina Masquerade": [[3, null]], "What is MyST?": [[4, "what-is-myst"]], "What is Reinforcement Learning?": [[7, "what-is-reinforcement-learning"]], "Why another RLHF algorithm?": [[2, "why-another-rlhf-algorithm"]], "Wiring\u00a0GRPOTrainer": [[1, "wiring-grpotrainer"]]}, "docnames": ["content", "grpo_implement", "grpo_intro", "intro", "markdown", "markdown-notebooks", "notebooks", "rl_llm_intro", "rl_llm_reward_models"], "envversion": {"sphinx": 62, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9}, "filenames": ["content.md", "grpo_implement.md", "grpo_intro.md", "intro.md", "markdown.md", "markdown-notebooks.md", "notebooks.ipynb", "rl_llm_intro.md", "rl_llm_reward_models.md"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [1, 4, 5, 6, 7], "0": [1, 2, 6, 7], "000": 1, "001": 1, "01": 1, "05": 1, "1": [1, 2, 6, 7], "10": 6, "100": 6, "12": [1, 2], "128": 1, "16": 1, "17": 2, "19680801": 6, "1e": 1, "2": [1, 2, 5, 6], "200": 2, "204": 2, "214": 2, "240": 2, "25": 2, "28": 1, "2e": 1, "3": [1, 2, 6], "30": [1, 2], "32": 1, "3b": 1, "4": [2, 5, 6], "40": 1, "42": 1, "43": 2, "5": [1, 2, 6], "50": 1, "50_000": 1, "512": 1, "58": 2, "5e": 1, "6": 1, "6pt": [1, 2], "75": 2, "7b": 1, "8": 1, "9": 1, "A": [1, 2, 7], "As": [5, 6], "But": 6, "For": [1, 4, 6, 7], "If": [1, 5], "In": [6, 7], "It": [4, 7], "No": [2, 6], "That": 5, "The": [1, 2, 4, 5, 7], "There": [0, 6], "To": 7, "With": 5, "_": 7, "_i": 2, "_t": 2, "a_0": 7, "a_t": 2, "about": [4, 5, 6, 7], "abov": 1, "abrupt": 7, "acceler": [1, 7], "accept": 4, "access": 1, "accuraci": [1, 7], "action": 7, "activ": 1, "actual": 1, "adapt": 7, "add_": 6, "adher": 7, "adjust": 7, "advanc": 3, "advantag": [1, 2], "after": [1, 2, 7], "agent": 7, "align": [1, 2, 6], "all": [4, 5], "allow": 4, "also": [4, 5, 6], "amount": 7, "an": [1, 2, 4, 7], "ani": [1, 5], "anneal": 1, "answer": [1, 2, 7], "append": 1, "appli": 7, "approx": 2, "ar": [0, 1, 2, 4, 5, 7], "arg": 1, "around": 1, "arrai": [1, 6], "artifici": 3, "ascent": 2, "assess": 7, "astral": 1, "attent": 1, "attn": 1, "auto": 1, "automat": 1, "automodelforcausallm": 1, "autotoken": 1, "avail": 1, "averag": 2, "avoid": [1, 7], "ax": 6, "back": 2, "base": [5, 7], "baselin": 2, "batch": [1, 2], "batch_siz": 1, "becaus": [1, 2], "befor": 1, "begin": [1, 2, 6, 7], "behavior": 7, "being": 4, "below": 1, "beta": [1, 2], "better": 2, "bib": 4, "bibliographi": 4, "bibtex": 4, "big": 2, "bigger": 1, "bigl": [1, 2, 7], "bigr": [1, 2, 7], "bin": 1, "bitsandbyt": 1, "block": 5, "book": [4, 5, 6], "bootstrap": 2, "both": 4, "bound": 1, "box": 4, "brake": 7, "buffer": 2, "build": 4, "built": 5, "calcul": 7, "call": [4, 6], "callback": 1, "can": [1, 4, 5, 6, 7], "candid": 2, "caption": 5, "causal_lm": 1, "cell": 6, "chang": 7, "channel": 3, "check": 6, "checkpoint": 1, "cite": 4, "classic": 2, "clip": 1, "clip_rang": 1, "clock": 2, "cm": 6, "cmap": 6, "code": 5, "cold": 6, "collis": 7, "color": 6, "column": 1, "combin": 7, "come": 7, "command": 5, "commonmark": 4, "compar": 2, "compil": 1, "complet": [1, 2, 7], "complex": 3, "compon": 7, "comprehens": 7, "comput": [1, 2, 7], "concept": 3, "config": 1, "consid": 7, "consumpt": 2, "content": [4, 5, 7], "continu": 7, "control": 7, "converg": 1, "convert": 5, "coolwarm": 6, "copi": 1, "core": 1, "correct": 7, "cost": 2, "cover": 0, "crash": 1, "creat": [1, 6], "criteria": 7, "critic": 1, "cuda": 1, "cuda_available_devic": 1, "cumul": 7, "curl": 1, "current": [2, 7], "curriculum": 1, "custom": 1, "custom_lin": 6, "cut": [2, 3], "cycler": 6, "d": [1, 5], "d_": [1, 2], "data": [1, 6, 7], "decai": 1, "decis": 7, "deep": 3, "def": 1, "default": 5, "defin": [2, 5], "definit": 1, "degener": 2, "deliv": 2, "demo": 1, "demystifi": 3, "depend": 4, "design": 2, "destin": 7, "detail": 5, "determin": 7, "devic": 1, "device_map": 1, "dictionari": 1, "differ": [4, 7], "direct": 5, "disabl": 1, "discount": 7, "displai": 5, "dissemin": 7, "distil": 1, "distribut": 7, "dive": 3, "diverg": 1, "do": [0, 4, 6], "document": [4, 5, 6], "dollar": 6, "draw": 1, "drift": [1, 2], "drop": 1, "dtype": 1, "duplic": 1, "dure": 1, "e": [1, 7], "each": [1, 2, 7], "ecosystem": 4, "edg": 3, "effect": 2, "effici": 2, "elimin": 2, "els": 1, "emb": 6, "empir": [1, 2], "enabl": 1, "end": [1, 2, 6], "end_bonu": 1, "endswith": 1, "engin": 3, "enlarg": 1, "ensur": [1, 7], "entir": 2, "entiti": 7, "environ": 7, "equat": 7, "error": [2, 7], "escap": 6, "essenti": 7, "etc": 6, "evalu": 7, "ever": 2, "everi": 2, "exact": 2, "exampl": [1, 4, 6], "execut": [1, 5, 7], "exit": 1, "expect": [1, 7], "expens": 1, "expert": 3, "explod": 1, "extens": 4, "extra": 1, "extrem": 1, "factor": [1, 7], "factual": 7, "far": [2, 7], "feedback": 7, "few": 0, "fewer": 2, "field": 1, "fig": 6, "figsiz": 6, "figur": 5, "file": 5, "fine": 7, "first": 1, "fix": 6, "flash": 1, "flat": 1, "flavor": 4, "float": 1, "float32": 1, "follow": [4, 5, 7], "form": [1, 2], "formal": 7, "forward": 1, "fp16": 1, "frac": [1, 2], "framework": 7, "freez": 1, "from": [1, 6, 7], "from_pretrain": 1, "frozen": 1, "function": [2, 4, 7], "further": 7, "fuse": 1, "futur": 3, "g": [1, 2, 7], "g_t": 7, "gain": 2, "gamma": 7, "gb": 1, "gener": 7, "get": [2, 4, 5], "get_peft_model": 1, "give": 2, "given": 7, "goal": 7, "good": 2, "gpu": 2, "gpu_devic": 1, "gradient": [2, 7], "gradient_accumulation_step": 1, "ground_truth": 1, "group": [1, 3], "group_siz": 1, "grpo": 3, "grpo_run": 1, "grpoconfig": 1, "guid": [3, 6, 7], "ha": 2, "hallucin": 7, "hang": 1, "harm": 7, "harmless": 7, "hat": 2, "have": [1, 5], "head": 1, "heavi": 2, "help": [4, 7], "here": [4, 6], "heurist": 2, "hf": 1, "higher": 2, "holdgraf_evidence_2014": 4, "horizon": 2, "hot": 6, "hover": 1, "how": [0, 5], "html": 6, "http": 1, "huggingfac": 3, "hyper": 2, "i": [1, 2, 5, 6], "ii": 6, "imag": 6, "implement": 3, "import": [1, 6], "includ": [5, 6, 7], "increas": 1, "indic": 1, "inform": [5, 6, 7], "infti": 7, "init": 5, "initi": [1, 7], "inlin": 4, "input": [1, 4, 7], "insert": 4, "insid": [1, 2], "insight": 3, "inspect": 1, "instal": 1, "instanti": 1, "instead": 2, "instruct": [1, 5, 7], "intellig": 3, "interact": [6, 7], "intern": 1, "introduct": 3, "intuit": 1, "involv": 7, "ion": 6, "ipynb": 4, "irrelev": 2, "issu": 1, "iter": 2, "its": [2, 7], "j": [1, 2, 7], "jupyt": [4, 5, 6], "jupyterbook": 4, "jupytext": 5, "just": [2, 4, 7], "k": [2, 7], "keep": [1, 2, 6], "kei": [1, 7], "kernel": [1, 5], "kind": 4, "kl": [1, 2], "l": 1, "l_": 2, "la_": 6, "lane": 7, "languag": 4, "larg": 2, "larger": 1, "last": 6, "launch": 1, "ldot": 7, "learn": 2, "learnabl": 7, "learning_r": 1, "left": 7, "legend": 6, "len": 1, "length_penalti": 1, "leq": 7, "let": [5, 7], "level": 2, "lib": 1, "librari": 1, "lightweight": 2, "like": [4, 5], "line": [4, 5, 6], "line2d": 6, "linspac": 6, "ll": 4, "llm": 2, "load": 1, "load_dataset": 1, "load_in_4bit": 1, "logic": 1, "logit": 2, "logspac": 6, "long": [1, 2, 7], "longrightarrow": 2, "lora_alpha": 1, "lora_cfg": 1, "lora_dropout": 1, "loraconfig": 1, "loss": 2, "lot": [4, 6], "lower": [1, 2], "lr": 1, "lssf": 1, "lw": 6, "machin": 7, "make": 6, "manag": 1, "mandatori": 1, "maneuv": 7, "mani": [0, 4, 5], "map": [1, 7], "mapsto": 2, "markdownfil": 5, "markedli": 4, "markup": 4, "match": [1, 2], "math": 6, "mathbb": 7, "mathcal": 1, "mathrm": [1, 2], "matplotlib": 6, "matter": 2, "max": 1, "maxim": 7, "maximis": 1, "mbox": 6, "md": [4, 5], "mean": [1, 2, 6], "medium": 6, "meet": 7, "memori": [1, 2], "method": [2, 7], "metric": 2, "mid": [1, 2, 7], "mimic": 1, "min": [1, 2], "mini": 2, "mini_batch_s": 1, "minim": [1, 7], "minu": 2, "misinform": 7, "mix": 2, "mixed_precis": 1, "ml": 3, "model": [1, 2, 3], "model_nam": 1, "modul": 6, "modulenotfounderror": 6, "more": [1, 5, 6], "moreov": 4, "most": [4, 6, 7], "mu": 2, "mu_r": [1, 2], "multipli": 1, "must": [4, 7], "n": 6, "name": 6, "narrow": 1, "need": [1, 2, 5], "neg": [2, 7], "network": 2, "never": 1, "new": [1, 2, 7], "nltk": 1, "none": 1, "normalis": [1, 2], "note": 4, "notebook": 4, "np": [1, 6], "nudg": 2, "num_process": 1, "numpi": [1, 6], "o": 1, "object": [1, 7], "observ": 2, "off": [4, 5], "offer": 7, "often": [1, 7], "old": 2, "onboard": 7, "one": 4, "onli": 2, "oom": 1, "operatornam": [1, 2], "optim": [2, 7], "optimis": 3, "option": [1, 2], "oracl": 2, "org": 4, "other": [2, 5], "out": [1, 6], "outcom": 7, "outperform": 1, "output": [1, 2, 5, 7], "over": [1, 7], "overview": [3, 4], "p": 7, "packag": 1, "page": [4, 5], "pairwis": 1, "paradigm": 7, "parallel": 2, "paramet": [2, 7], "parameter": 7, "pass": 1, "path": 5, "peft": 1, "penalis": 1, "penalti": [1, 2, 7], "per": [1, 2], "perform": 7, "pi": 7, "pi_": [1, 2, 7], "pip": 1, "plot": 6, "plt": 6, "plug": 2, "point": 1, "polici": [3, 7], "polit": 7, "poor": 7, "posit": [2, 7], "possibl": 7, "post": 6, "power": 4, "ppo_epoch": 1, "pre": 7, "predict": 2, "predictor": 7, "presenc": 5, "presid": 7, "principl": 7, "print": 5, "probabl": 7, "problem": 7, "process": [1, 7], "project": 2, "prompt": [1, 2, 7], "prop": 2, "prop_cycl": 6, "properli": 4, "properti": 2, "proven": 2, "provid": [1, 7], "purpos": [1, 4], "push": 2, "py": 1, "pyplot": 6, "python": 1, "q_proj": 1, "qquad": 2, "quad": 2, "qualiti": 7, "quantis": 1, "quickli": [1, 2], "qwen": 1, "qwen2": 1, "r": [1, 2, 7], "r_": [1, 2, 7], "r_1": 7, "r_i": [1, 2], "r_j": [1, 2], "r_t": [2, 7], "rais": 1, "ram": 1, "randn": 6, "random": 6, "rang": [1, 6], "rate": 2, "ratio": 2, "raw": [1, 2], "rcparam": 6, "reach": 7, "real": 2, "reason": [1, 2], "rebuild": 1, "receiv": [1, 7], "recent": 6, "reduc": 1, "ref": [1, 2], "ref_model": 1, "refer": [1, 2, 4], "refin": 7, "refresh": 2, "regular": 4, "rel": [1, 3], "reli": 2, "remedi": 1, "render": 4, "replai": 2, "repres": 7, "represent": 7, "reproduc": 6, "requir": 2, "respons": [1, 7], "rest": 5, "result": 7, "return": [1, 7], "reward": [2, 3, 7], "reward_fn": 1, "right": 7, "rise": 1, "rl": [2, 3], "rm": 2, "room": 1, "roughli": 1, "row": 1, "run": [1, 5], "s_0": 7, "s_1": 7, "s_t": 2, "same": [2, 4], "sampl": [1, 2, 6], "satur": 2, "save": 1, "scalar": 2, "scale": 2, "scenario": 7, "score": [1, 2], "sec": 1, "section": 0, "see": [4, 5, 6], "seed": [1, 6], "select": [1, 7], "sensor": 7, "sentenc": 1, "separ": 2, "sequenc": 7, "seri": 7, "serv": 4, "set": [1, 2], "setup": 7, "sh": 1, "shape": 3, "share": 3, "sharpen": 2, "short": 0, "should": [1, 5, 7], "show": [4, 5], "shown": 5, "shuffl": 1, "sigma": 2, "sigma_r": [1, 2], "sign": 6, "signal": [1, 2, 7], "similar": 4, "simpl": 4, "simple_reward": 1, "simpli": 2, "singl": 2, "situat": 7, "slight": 4, "slightli": 2, "slow": 1, "small": [1, 4], "smaller": 1, "smoother": 2, "so": [0, 2, 5, 7], "softwar": 3, "solut": 2, "some": [4, 6], "sourc": 1, "span": 4, "special": 4, "specif": [2, 4, 7], "speed": 1, "sphinx": 4, "split": 1, "spot": 1, "spread": 1, "sqrt": [1, 2], "stabil": 2, "stabilis": 1, "stabl": 2, "stai": 2, "stand": 4, "start": [1, 4, 5], "starter": 4, "state": [6, 7], "statist": 2, "std": 1, "steer": 7, "step": [1, 7], "stop": [2, 7], "store": 4, "str": 1, "strategi": 7, "strength": 1, "strip": 1, "strong": 2, "structur": [4, 7], "style": 2, "subplot": 6, "subscrib": 3, "subsequ": 7, "sudden": 1, "sum_": [1, 2, 7], "supervis": 7, "support": [2, 5], "sure": 6, "surrog": 2, "surround": 7, "sweet": 1, "switch": 1, "symptom": 1, "syntax": 4, "system": [1, 7], "t": [1, 2, 6, 7], "t_": 7, "t_1": 7, "t_2": 7, "t_i": 7, "take": 7, "taken": 7, "target_kl": 1, "target_modul": 1, "task": [1, 2, 7], "task_typ": 1, "td": 2, "techniqu": 7, "term": [1, 7], "tex": 6, "text": [1, 2, 4, 5, 7], "than": 2, "thei": [4, 7], "them": 2, "theta": [1, 2, 7], "theta_": 2, "thi": [0, 2, 4, 5, 6, 7], "thing": 5, "those": 4, "through": [2, 3, 7], "throughput": 1, "ti": 2, "tild": [1, 2], "time": [2, 7], "tip": [0, 1], "tldr": 1, "todai": 7, "token": [1, 2], "too": 2, "tool": 4, "top": 5, "torch": 1, "toward": 2, "traceback": 6, "train": [1, 2], "train_dataset": 1, "trainer": 1, "trajectori": [2, 7], "tranfer": 1, "transform": 1, "transit": 7, "travel": 7, "treat": [2, 5], "trend": 1, "trial": 7, "trim": 2, "trl": 1, "true": 1, "tune": [1, 7], "twist": 2, "two": [1, 4, 5], "type": 1, "typic": [1, 7], "understand": 5, "untokenis": 1, "updat": 2, "upgrad": 1, "us": [1, 2, 4, 5, 7], "usa": 7, "use_fast": 1, "user": [1, 7], "usual": 1, "uv": 1, "v_proj": 1, "valu": [1, 2], "varepsilon": [1, 2], "varianc": [1, 2], "variat": 4, "vast": 7, "vehicl": 7, "venv": 1, "veri": 2, "verifi": 7, "vert": 1, "virtualenv": 1, "vllm": 1, "vocabulari": 7, "vram": 1, "wai": 0, "wall": 2, "want": 6, "we": [1, 3, 5], "weight": 1, "well": [1, 6], "what": 2, "when": [2, 4, 5, 7], "where": [1, 2, 7], "wherea": 4, "whether": 4, "which": [2, 5, 7], "while": 2, "within": 2, "without": [1, 2], "word_token": 1, "work": [2, 6], "write": [0, 4, 5], "written": [4, 5], "x": 1, "y_i": 1, "ye": 2, "yield": 2, "you": [1, 2, 3, 4, 5, 6], "your": [1, 4, 5, 6], "youtub": 3, "z": 1, "\u03b2": 2, "\u03b5": 2, "\u03bc": 2}, "titles": ["Content in Jupyter Book", "GRPO: Huggingface Implementation", "Group Relative Policy Optimisation (GRPO): Overview", "Welcome to Machina Masquerade", "Markdown Files", "Notebooks with MyST Markdown", "Content with notebooks", "RL Introduction", "Reward Models"], "titleterms": {"": 2, "4": 1, "add": 5, "advanc": 1, "algorithm": 2, "align": 7, "an": 5, "anoth": 2, "arithmet": 2, "bit": 1, "block": 6, "book": 0, "car": 7, "cell": 5, "choos": 1, "citat": 4, "clip": 2, "code": [1, 6], "concept": 7, "configur": 1, "content": [0, 6], "core": 7, "correl": 1, "cours": 3, "creat": 5, "critic": 2, "dataset": 1, "depend": 1, "design": 1, "direct": 4, "ditch": 2, "drive": 7, "environ": 1, "exampl": [2, 5, 7], "file": 4, "flow": 7, "from": 2, "fsdp": 1, "function": 1, "gpu": 1, "group": 2, "grpo": [1, 2], "grpotrain": 1, "how": 7, "huggingfac": 1, "hyper": 1, "i": [4, 7], "idea": 2, "implement": 1, "introduct": 7, "jupyt": 0, "kei": 2, "languag": 7, "larg": 7, "learn": [1, 3, 4, 7], "llm": [3, 7], "lora": 1, "machina": 3, "markdown": [4, 5, 6], "masquerad": 3, "mathemat": [2, 7], "metadata": 5, "model": [7, 8], "modern": 7, "more": 4, "multi": 1, "myst": [4, 5, 6], "next": 7, "notat": 7, "notebook": [5, 6], "nutshel": 1, "object": 2, "oper": 7, "optimis": 2, "output": 6, "overview": 2, "paramet": 1, "perspect": 7, "polici": 2, "ppo": 2, "practic": 1, "predict": 7, "prepar": 1, "prose": 2, "quant": 1, "quickli": 5, "real": 7, "recap": 2, "reinforc": [3, 7], "rel": 2, "reward": [1, 8], "rl": 7, "rlhf": 2, "role": 4, "sampl": 4, "scale": 1, "self": 7, "step": 2, "theori": 1, "toi": 2, "token": 7, "track": 1, "train": 7, "v": 2, "welcom": 3, "what": [4, 7], "why": 2, "wire": 1, "world": 7, "yaml": 5}})